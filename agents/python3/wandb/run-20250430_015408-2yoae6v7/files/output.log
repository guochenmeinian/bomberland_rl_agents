[Checkpoint] Loaded checkpoints/ppo_checkpoint_ep50.pt (episode 50)
开始 Episode 51/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 52/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
train.py:84: RuntimeWarning: coroutine 'SafeGym.make' was never awaited
  gym.make("bomberland-env", current_state["payload"])
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 53/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 54/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 55/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 56/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 57/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 58/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 59/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 60/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
[Sync] target_agent 同步于 Episode 60
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
🚀 Completed 20 episodes in 48.91 seconds (Avg 2.45 sec/episode)
开始 Episode 61/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 62/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 63/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 64/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 65/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 66/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 67/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 68/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 69/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 70/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 71/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 72/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 73/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 74/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 75/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
[Sync] target_agent 同步于 Episode 75
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 76/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 77/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 78/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 79/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 80/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
🚀 Completed 20 episodes in 98.12 seconds (Avg 4.91 sec/episode)
开始 Episode 81/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 82/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 83/10000
尝试连接 (1/5)...
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 84/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 85/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 86/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 87/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 88/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 89/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 90/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
[Sync] target_agent 同步于 Episode 90
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 91/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 92/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 93/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 94/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 95/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 96/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 97/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 98/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 99/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 100/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
[评估] 开始 Evaluation at Episode 100
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
[总体错误] Episode 100 失败: 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "train.py", line 176, in run_training
    await evaluate(agent, target_agent, episode)
  File "train.py", line 261, in evaluate
    reward = calculate_reward(next_state, current_state, action_indices_a, episode, agent_id="a")
  File "/app/utils/rewards.py", line 44, in calculate_reward
    unit_ids = state["agents"][agent_id]["unit_ids"]
TypeError: 'NoneType' object is not subscriptable
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
🚀 Completed 20 episodes in 101.98 seconds (Avg 5.10 sec/episode)
开始 Episode 101/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
train.py:226: RuntimeWarning: coroutine 'SafeGym.make' was never awaited
  gym.make("bomberland-env", current_state["payload"])
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 102/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Step 错误: 环境未初始化，请先调用make方法
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 103/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 104/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 105/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
[Sync] target_agent 同步于 Episode 105
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 106/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 107/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 108/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 109/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 110/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 111/10000
尝试连接 (1/5)...
连接成功！
尝试重置游戏地图
Traceback (most recent call last):
  File "/app/env/safe_gym.py", line 124, in step
    raise ValueError("环境未初始化，请先调用make方法")
ValueError: 环境未初始化，请先调用make方法
Step 错误: 环境未初始化，请先调用make方法
警告: step 返回了 None，跳出当前 episode
关闭环境连接...
Connection with server closed
Connection with server closed
环境连接已关闭
开始 Episode 112/10000
尝试连接 (1/5)...
连接成功！
